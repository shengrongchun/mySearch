webpackJsonp([1],{"/wAz":function(e,t){},"/xfL":function(e,t){},0:function(e,t){},"0Kc/":function(e,t){},1:function(e,t){},"44Bo":function(e,t){},"4uCP":function(e,t){},"5HsS":function(e,t){},"7bnT":function(e,t){},AjxE:function(e,t){},BAHr:function(e,t){},BoN9:function(e,t){},"Cy/K":function(e,t){},Fc11:function(e,t){},JHnt:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("4uCP"),n("nXbH");var i=n("jFa7"),a=n.n(i),r=(n("VVqU"),n("CKrr")),s=n.n(r),o=(n("ZD0t"),n("oFqZ")),l=n.n(o),c=(n("xpkF"),n("OQP0")),u=n.n(c),d=(n("fqtM"),n("n4bP")),m=n.n(d),p=(n("RJkU"),n("Q3iP")),f=n.n(p),g=(n("S+8z"),n("Urb5")),v=n.n(g),h=(n("5HsS"),n("fp1j")),_=n.n(h),b=(n("7bnT"),n("Tc97")),y=n.n(b),w=(n("rI3P"),n("340D")),k=n.n(w),C=(n("ONfh"),n("AnbK")),F=n.n(C),L=(n("44Bo"),n("x8/L")),x=n.n(L),O=(n("ziMA"),n("/zTz")),D=n.n(O),A=(n("0Kc/"),n("CXBd")),G=n.n(A),M=(n("kDaR"),n("gCB4")),I=n.n(M),S=(n("uezj"),n("BZlA")),N=n.n(S),T=(n("gT1N"),n("qYX6")),H=n.n(T),$=(n("YtW1"),n("Y0bJ")),R=n.n($),U=(n("/xfL"),n("UOVs")),E=n.n(U),q=(n("k2Oz"),n("fS7w")),j=n.n(q),K=(n("qqnD"),n("lLeV")),P=n.n(K),V=(n("BAHr"),n("Veir")),B=n.n(V),z=(n("vJvE"),n("erho")),X=n.n(z),Y=(n("X0dM"),n("5qDq")),Z=n.n(Y),J=(n("ZfCT"),n("i8a1")),Q=n.n(J),W=(n("Fc11"),n("zlcW")),ee=n.n(W),te=(n("/wAz"),n("O534")),ne=n("34v0"),ie=n.n(ne),ae=n("EcfS"),re={name:"siderLeft",data:function(){return{searchValue:null,type:"friends",transferIndex:null,contextMenuFriData:{menuName:"friends",axios:{x:null,y:null},menulists:[{fnHandler:"delFriend",btnName:"删除好友"}]},contextMenuGroData:{menuName:"groups",axios:{x:null,y:null},menulists:[{fnHandler:"removeGroup",btnName:"退出群组"}]},contextMenuNoticeData:{menuName:"notice",axios:{x:null,y:null},menulists:[{fnHandler:"delNotice",btnName:"删除消息"}]},contextMenuInfoData:{menuName:"info",axios:{x:null,y:null},menulists:[{fnHandler:"delInfo",btnName:"删除会话"}]}}},computed:ie()({},Object(ae.e)(["user","friendsList","groupsList","currentOne","activeMsgList","counts","noticeList"]),Object(ae.c)(["msgListNum"]),{chatSearchList:function(){return this.friendsList.concat(this.groupsList)}}),methods:ie()({},Object(ae.b)(["changeCurrentOne","addFriendOk","deleteUser","deleteGroup"]),Object(ae.d)(["setAddFriOrGroDialog","delNoticeListItem","delActiveMsgListItem","clearCurrentone"]),{showMenu:function(e,t,n){this.transferIndex=t,e.preventDefault();var i=e.clientX,a=e.clientY;n.axios={x:i,y:a}},delFriend:function(e){var t=this;this.$confirm("确定删除好友吗？").then(function(){t.deleteUser(e),t.delActiveMsgListItem(e)}).catch(function(){})},removeGroup:function(e){var t=this;this.$confirm("确定退出群组吗？").then(function(){t.deleteGroup(e),t.delActiveMsgListItem(e)}).catch(function(){})},delNotice:function(e){var t=this;this.$confirm("确定删除消息吗？").then(function(){t.delNoticeListItem(e),"add"==e.type&&t.addError(e)}).catch(function(){})},delInfo:function(e){var t=this;this.$confirm("确定删除会话吗？").then(function(){t.delActiveMsgListItem(e),t.currentOne._id==e._id&&t.clearCurrentone()}).catch(function(){})},search:function(e,t){t(e?this.chatSearchList.filter(this.createFilter(e)):this.chatSearchList)},createFilter:function(e){return function(t){return 0===t.name.toLowerCase().indexOf(e.toLowerCase())}},handleSelect:function(e){this.changeCurrentOne(e)},showDialog:function(e){this.setAddFriOrGroDialog({type:e,show:!0})},changeActiveOne:function(e){var t=this.currentOne;t&&t._id===e._id||this.changeCurrentOne(e)},addOk:function(e){this.addFriendOk({mask:!0,data:e})},addError:function(e){this.addFriendOk({mask:!1,data:e})}})},se={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sider-left"},[n("header",{staticClass:"left-header"},[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:e.user.avatar}})]),e._v(" "),n("div",{staticClass:"info"},[n("span",{staticClass:"display-name"},[e._v(e._s(e.user.name))]),e._v(" "),n("div",{staticClass:"add"},[n("el-dropdown",{staticClass:"dropdown",attrs:{trigger:"click"},on:{command:e.showDialog}},[n("span",{staticClass:"el-dropdown-link"},[n("i",{staticClass:"iconself iconfont icon-other"})]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"friends"}},[e._v("加好友")]),e._v(" "),n("el-dropdown-item",{attrs:{command:"groups"}},[e._v("加群组")]),e._v(" "),n("el-dropdown-item",{attrs:{command:"createGroups"}},[e._v("创建群组")])],1)],1)],1)])]),e._v(" "),n("div",{staticClass:"left-search"},[n("el-autocomplete",{staticClass:"input inline-block",attrs:{"prefix-icon":"el-icon-search",placeholder:"搜索",size:"small","trigger-on-focus":!1,"popper-class":"search-chat-item","fetch-suggestions":e.search},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){return[n("img",{staticClass:"avatar",attrs:{width:"30",src:t.item.avatar}}),e._v(" "),n("span",{staticClass:"name"},[e._v(e._s(t.item.name))])]}}]),model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),n("div",{staticClass:"left-body"},[n("div",{staticClass:"tabs"},[n("ul",[n("li",{on:{click:function(t){e.type="info"}}},[n("el-badge",{staticClass:"item",attrs:{value:e.msgListNum,max:99}},["info"==e.type?n("i",{staticClass:"iconself iconfont icon-interactive_fill active"}):n("i",{staticClass:"iconself iconfont icon-interactive"})])],1),e._v(" "),n("li",{on:{click:function(t){e.type="friends"}}},[n("el-badge",{staticClass:"item",attrs:{value:0,max:99}},["friends"==e.type?n("i",{staticClass:"iconself iconfont icon-addressbook_fill active"}):n("i",{staticClass:"iconself iconfont icon-addressbook"})])],1),e._v(" "),n("li",{on:{click:function(t){e.type="notice"}}},[n("el-badge",{staticClass:"item",attrs:{value:e.noticeList.length,max:99}},["notice"==e.type?n("i",{staticClass:"iconself iconfont icon-remind_fill active"}):n("i",{staticClass:"iconself iconfont icon-remind"})])],1)])]),e._v(" "),n("div",{staticClass:"tabs-panel"},["info"==e.type?n("div",[n("el-menu",{staticClass:"left-menu",attrs:{"background-color":"#2e3238","text-color":"#fff","active-text-color":"#ffd04b"}},e._l(e.activeMsgList,function(t,i){return n("el-menu-item",{key:i,attrs:{index:i+""},on:{click:function(n){e.changeActiveOne(t)}}},[n("div",{on:{contextmenu:function(t){e.showMenu(t,i,e.contextMenuInfoData)}}},[n("img",{attrs:{src:t.avatar}}),e._v(" "),n("el-badge",{staticClass:"badge",attrs:{value:e.counts[t._id],max:99}},[n("span",[e._v(e._s(t.name))])])],1),e._v(" "),n("vue-context-menu",{staticClass:"customMenu",attrs:{contextMenuData:e.contextMenuInfoData,transferIndex:e.transferIndex},on:{delInfo:function(n){e.delInfo(t)}}})],1)}))],1):e._e(),e._v(" "),"friends"==e.type?n("div",[n("el-menu",{staticClass:"left-menu",attrs:{"background-color":"#2e3238","text-color":"#fff","active-text-color":"#ffd04b"}},[e.groupsList.length>0?n("el-menu-item-group",{attrs:{title:"群组"}},e._l(e.groupsList,function(t,i){return n("el-menu-item",{key:i,attrs:{index:i+"group"},on:{click:function(n){e.changeActiveOne(t)}}},[n("div",{on:{contextmenu:function(t){e.showMenu(t,i,e.contextMenuGroData)}}},[n("img",{attrs:{src:t.avatar}}),e._v(" "),n("span",[e._v(e._s(t.name))])]),e._v(" "),n("vue-context-menu",{staticClass:"customMenu",attrs:{contextMenuData:e.contextMenuGroData,transferIndex:e.transferIndex},on:{removeGroup:function(n){e.removeGroup(t)}}})],1)})):e._e(),e._v(" "),n("el-menu-item-group",{attrs:{title:"好友"}},e._l(e.friendsList,function(t,i){return n("el-menu-item",{key:i,attrs:{index:i+"fri"},on:{click:function(n){e.changeActiveOne(t)}}},[n("div",{on:{contextmenu:function(t){e.showMenu(t,i,e.contextMenuFriData)}}},[n("img",{attrs:{src:t.avatar}}),e._v(" "),n("span",[e._v(e._s(t.name))])]),e._v(" "),n("vue-context-menu",{staticClass:"customMenu",attrs:{contextMenuData:e.contextMenuFriData,transferIndex:e.transferIndex},on:{delFriend:function(n){e.delFriend(t)}}})],1)}))],1)],1):e._e(),e._v(" "),"notice"==e.type?n("div",[n("el-menu",{staticClass:"left-menu",attrs:{"background-color":"#2e3238","text-color":"#fff","active-text-color":"#ffd04b"}},e._l(e.noticeList,function(t,i){return n("el-menu-item",{key:i,staticClass:"noticeAddfri",attrs:{index:i+""}},[n("div",{on:{contextmenu:function(t){e.showMenu(t,i,e.contextMenuNoticeData)}}},[n("el-badge",{staticClass:"badge",attrs:{value:1,max:99}},[n("img",{attrs:{src:t.avatar}}),e._v(" "),n("span",[e._v(e._s(t.name))])]),e._v(" "),"resolve"==t.type?n("p",[e._v("同意添加好友")]):e._e(),e._v(" "),"reject"==t.type?n("p",[e._v("拒绝添加好友")]):e._e(),e._v(" "),"add"==t.type?n("p",[e._v("请求添加好友")]):e._e(),e._v(" "),"add"==t.type?n("div",[n("el-button",{attrs:{size:"mini"},on:{click:function(n){e.addError(t)}}},[e._v("不同意")]),e._v(" "),n("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(n){e.addOk(t)}}},[e._v("同意")])],1):e._e()],1),e._v(" "),n("vue-context-menu",{staticClass:"customMenu",attrs:{contextMenuData:e.contextMenuNoticeData,transferIndex:e.transferIndex},on:{delNotice:function(n){e.delNotice(t)}}})],1)}))],1):e._e()])])])},staticRenderFns:[]};var oe=n("ngHh")(re,se,!1,function(e){n("X7Q4")},"data-v-0d5db0b6",null).exports,le={bind:function(e,t,n){var i=function(i){if(!n.context||e.contains(i.target))return!1;t.expression?n.context[e["@@clickoutsideContext"].methodName](i):e["@@clickoutsideContext"].bindingFn(i)};e["@@clickoutsideContext"]={documentHandler:i,methodName:t.expression,bindingFn:t.value},setTimeout(function(){document.addEventListener("click",i)},0)},update:function(e,t){e["@@clickoutsideContext"].methodName=t.expression,e["@@clickoutsideContext"].bindingFn=t.value},unbind:function(e){document.removeEventListener("click",e["@@clickoutsideContext"].documentHandler)}},ce={name:"siderRight",data:function(){return{img:null,faceShow:!1,faceList:[],faceTitleList:[]}},computed:ie()({},Object(ae.e)(["currentOne","messages","user","counts","groupMemberList"]),{messageList:function(){return this.scrollTop(),this.messages[this.currentOne._id]},editDom:function(){return document.getElementById("editArea")}}),methods:ie()({},Object(ae.b)(["pushMsg","deleteUser","changeCurrentOne","getGroupMember"]),{noCurrentNum:function(){this.counts[this.currentOne._id]>0&&this.changeCurrentOne(this.currentOne)},submitMsg:function(){var e=this.editDom.innerHTML;e&&!e.match(/^\s*$/)&&(this.pushMsg(e),this.editDom.innerHTML=null)},showHandleCommand:function(e){e&&this.getGroupMember(this.currentOne)},handleCommand:function(e){e._id!=this.user._id&&this.changeCurrentOne(e)},breakLine:function(e){this.editDom.innerHTML=this.editDom.innerHTML+"<br></br>",this.placeCaretAtEnd(this.editDom),this.$nextTick(function(){var t=e.target;t.scrollTop=t.scrollHeight})},placeCaretAtEnd:function(e){if(e.focus(),void 0!==window.getSelection&&void 0!==document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if(void 0!==document.body.createTextRange){var i=document.body.createTextRange();i.moveToElementText(e),i.collapse(!1),i.select()}},insertPic:function(e){this.img.style.backgroundPositionX=e.x,this.img.style.backgroundPositionY=e.y,this.editDom.appendChild(this.img.cloneNode(!0))},scrollTop:function(){this.$nextTick(function(){document.getElementById("right-body").scrollTop=document.getElementById("right-body").scrollHeight})},hideFace:function(){this.faceShow=!1}}),directives:{clickoutside:le},mounted:function(){this.img=document.createElement("img"),this.img.width=20,this.img.height=20,this.img.src=n("xet3"),this.img.setAttribute("class","buImg"),this.faceTitleList=["微笑","撇嘴","色","发呆","得意","流泪","害羞","闭嘴","睡","大哭","尴尬","发怒","调皮","呲牙","惊讶","难过","酷","冷汗","抓狂","吐","偷笑","愉快","白眼","傲慢","饥饿","困","惊恐","流汗","憨笑","悠闲","奋斗","咒骂","疑问","嘘","晕","疯了","衰","骷髅","敲打","再见","擦汗","抠鼻","鼓掌","糗大了","坏笑","左哼哼","右哼哼","哈欠","鄙视","委屈","快哭了","阴险","亲亲","吓","可怜","菜刀","西瓜","啤酒","篮球","乒乓","咖啡","饭","猪头","玫瑰","凋谢","嘴唇","爱心","心碎","蛋糕","闪电","炸弹","刀","足球","瓢虫","便便","月亮","太阳","礼物","拥抱","强","弱","握手","胜利","抱拳","勾引","拳头","差劲","爱你","NO","OK","爱情","飞吻","跳跳","发抖","怄火","转圈","磕头","回头","跳绳","投降","激动","乱舞","献吻","左太极","右太极","嘿哈","捂脸","奸笑","机智","皱眉","耶","鸡","红包"];for(var e=0;e<113;e++)this.faceList.push({title:this.faceTitleList[e],class:"face"+e,x:24*-parseInt(e%15)+"px",y:24*-parseInt(e/15)+"px"})}},ue={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sider-right"},[n("div",[e.currentOne?n("div",{staticClass:"right-header"},[e.currentOne.owner?n("el-dropdown",{attrs:{trigger:"click"},on:{"visible-change":e.showHandleCommand,command:e.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[e._v("\n                    "+e._s(e.currentOne.name)),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),n("el-dropdown-menu",{staticClass:"show-members",attrs:{slot:"dropdown"},slot:"dropdown"},[e._l(e.groupMemberList,function(t,i){return n("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:e.groupMemberList.length>0,expression:"groupMemberList.length>0"}],key:i+"",attrs:{command:t,title:t.name}},[n("img",{staticClass:"avatar",attrs:{width:"50",src:t.avatar}}),e._v(" "),n("span",{staticClass:"name"},[e._v(e._s(t.name))])])}),e._v(" "),n("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:0==e.groupMemberList.length,expression:"groupMemberList.length==0"}]},[n("i",{staticClass:"el-icon-loading"})])],2)],1):n("span",[e._v(e._s(e.currentOne.name))])],1):e._e(),e._v(" "),e.currentOne?n("div",{staticClass:"right-body",attrs:{id:"right-body"}},[e.messageList&&e.messageList.length>0?n("div",e._l(e.messageList,function(t,i){return n("div",{key:i,staticClass:"message",class:{me:e.user._id===t._id}},[n("img",{staticClass:"avatar",attrs:{title:t.name,src:t.avatar}}),e._v(" "),n("div",{staticClass:"content"},[e.user._id!==t._id?n("h4",{staticClass:"nickname"},[e._v(e._s(t.name))]):e._e(),e._v(" "),n("div",{staticClass:"bubble",class:{rightself:e.user._id===t._id,left:e.user._id!==t._id}},[n("div",{staticClass:"bubble_cont"},[n("pre",{domProps:{innerHTML:e._s(t.content)}})])])])])})):n("p",{staticClass:"noMsg"},[e._v("暂时没有新消息")])]):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.currentOne,expression:"currentOne"}],staticClass:"right-footer"},[n("div",{staticClass:"bar"},[e.faceShow?n("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.hideFace,expression:"hideFace"}],staticClass:"face"},[n("div",{staticClass:"faceImg"},e._l(e.faceList,function(t,i){return n("a",{class:"qq "+t.class,style:{backgroundPositionX:t.x,backgroundPositionY:t.y},attrs:{title:t.title},on:{click:function(n){e.insertPic(t)}}},[e._v(e._s(t.title))])}))]):e._e(),e._v(" "),n("span",{on:{click:function(t){t.stopPropagation(),e.faceShow=!0}}},[n("i",{staticClass:"iconself iconfont icon-emoji"})])]),e._v(" "),n("div",{staticClass:"submit"},[n("pre",{attrs:{id:"editArea",contenteditable:"true"},on:{focus:function(t){if(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return null;e.noCurrentNum(t)},keydown:[function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key)?(t.stopPropagation(),t.preventDefault(),t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:void e.submitMsg(t)):null},function(t){return("button"in t||!e._k(t.keyCode,"enter",13,t.key))&&t.ctrlKey?(t.stopPropagation(),t.shiftKey||t.altKey||t.metaKey?null:void e.breakLine(t)):null}]}})]),e._v(" "),n("div",{staticClass:"action"},[n("span",[e._v("按下Ctrl+Enter换行")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.submitMsg(t)}}},[e._v("发送")])],1)])])])},staticRenderFns:[]};var de={name:"weChat",components:{siderLeft:oe,siderRight:n("ngHh")(ce,ue,!1,function(e){n("RABp")},"data-v-03a2fc38",null).exports}},me={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"weChat"},[t("el-row",[t("el-col",{attrs:{span:8}},[t("sider-left")],1),this._v(" "),t("el-col",{attrs:{span:16}},[t("sider-right")],1)],1)],1)},staticRenderFns:[]};var pe={name:"shLogin",data:function(){return{}},components:{weChat:n("ngHh")(de,me,!1,function(e){n("BoN9")},"data-v-989a19b4",null).exports},computed:ie()({},Object(ae.e)(["user","noticeList","isOpen"]),Object(ae.c)(["msgListNum"]),{num:function(){return this.noticeList.length+this.msgListNum}}),methods:ie()({},Object(ae.d)(["setLoginDialog","setOpen"]),{handleCommand:function(e){"exit"==e?window.location.reload():"edit"==e&&this.login("edit")},showChat:function(){this.setOpen(!this.isOpen)},login:function(e){this.setLoginDialog({type:e,centerDialogVisible:!0})}})},fe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"shLogin"}},[e.user.name?n("div",[n("el-badge",{staticClass:"item",attrs:{value:e.num,max:99}},[n("i",{staticClass:"el-icon-message",on:{click:e.showChat}})]),e._v(" "),n("img",{staticStyle:{verticalAlign:"middle",borderRadius:"3px"},attrs:{src:e.user.avatar,width:"30"}}),e._v(" "),n("el-dropdown",{on:{command:e.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[e._v("\n                "+e._s(e.user.name)),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"edit"}},[e._v("修改信息")]),e._v(" "),n("el-dropdown-item",{attrs:{command:"exit",divided:""}},[e._v("退出")])],1)],1)],1):n("div",{staticClass:"user"},[n("el-button",{attrs:{type:"text"},on:{click:function(t){e.login("login")}}},[e._v("登录")]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(t){e.login("sign")}}},[e._v("注册")])],1),e._v(" "),n("div",{class:{open:e.isOpen},attrs:{id:"weChat"}},[n("span",{staticClass:"close",on:{click:e.showChat}},[e._v("×")]),e._v(" "),n("we-chat")],1)])},staticRenderFns:[]};var ge=n("ngHh")(pe,fe,!1,function(e){n("Cy/K")},"data-v-043d1392",null).exports,ve=n("GxZn"),he=n.n(ve),_e=n("Edqs"),be=n.n(_e),ye=(n("ZM3P"),n("haFB")),we=n.n(ye),ke={props:{trigger:{type:[String,Element],required:!0},uploadHandler:{type:Function},uploadUrl:{type:String},uploadHeaders:{type:Object},uploadFormName:{type:String,default:"file"},uploadFormData:{type:Object,default:function(){return{}}},mimes:{type:String,default:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},labels:{type:Object,default:function(){return{submit:"保存",cancel:"取消"}}}},data:function(){return{cropper:void 0,dataUrl:void 0,filename:void 0}},methods:{destroy:function(){this.cropper.destroy(),this.dataUrl=void 0},submit:function(){if(this.uploadUrl)this.uploadImage();else{if(!this.uploadHandler)throw new Error("No upload handler found.");this.uploadHandler(this.cropper)}this.destroy()},pickImage:function(){var e=this,t="avatar-img-input",n=document.querySelector("input#"+t+"[type=file]");null==n&&((n=document.createElement("input")).id=t,n.setAttribute("type","file"),n.setAttribute("accept",this.mimes),n.addEventListener("change",function(){if(null!=n.files&&null!=n.files[0]){var t=new FileReader;t.onload=function(t){e.dataUrl=t.target.result},t.readAsDataURL(n.files[0]),e.filename=n.files[0].fileName||"unknown",e.$emit("changed",n.files[0],t)}})),n.click()},createCropper:function(){var e=document.querySelector(".avatar-cropper-image-container img");this.cropper=new we.a(e,{aspectRatio:1,autoCropArea:1,viewMode:1,movable:!1,zoomable:!1,minCropBoxWidth:100,minCropBoxHeight:80})},uploadImage:function(){var e=this;this.cropper.getCroppedCanvas().toBlob(function(t){var n=new FormData,i=new XMLHttpRequest,a=be()({},e.uploadFormData);for(var r in a)n.append(r,a[r]);for(var s in n.append(e.uploadFormName,t,e.filename),e.$emit("uploading",n,i),i.open("POST",e.uploadUrl,!0),e.uploadHeaders)i.setRequestHeader(s,e.uploadHeaders[s]);i.onreadystatechange=function(){if(4===i.readyState){var t=JSON.parse(i.responseText);200===i.status?e.$emit("uploaded",t,n,i):e.$emit("error","Image upload fail.","upload",i)}},i.send(n)})}},mounted:function(){var e="object"==he()(this.trigger)?this.trigger:document.querySelector(this.trigger);e||this.$emit("error","No avatar make trigger found.","user"),e.addEventListener("click",this.pickImage)}},Ce={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.dataUrl?n("div",{staticClass:"avatar-cropper"},[n("div",{staticClass:"avatar-cropper-mark"},[n("a",{staticClass:"avatar-cropper-close",attrs:{href:"javascript:void(0);"},on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.destroy(t)}}},[e._v("×")])]),e._v(" "),n("div",{staticClass:"avatar-cropper-container"},[n("div",{staticClass:"avatar-cropper-image-container"},[n("img",{attrs:{src:e.dataUrl,alt:""},on:{load:function(t){t.stopPropagation(),e.createCropper(t)}}})]),e._v(" "),n("div",{staticClass:"avatar-cropper-footer"},[n("button",{staticClass:"avatar-cropper-btn",domProps:{textContent:e._s(e.labels.cancel)},on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.destroy(t)}}},[e._v("Cancel")]),e._v(" "),n("button",{staticClass:"avatar-cropper-btn",domProps:{textContent:e._s(e.labels.submit)},on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.submit(t)}}},[e._v("Submit")])])])]):e._e()},staticRenderFns:[]};var Fe=n("ngHh")(ke,Ce,!1,function(e){n("V/92")},null,null).exports,Le={name:"shDialog",components:{AvatarCropper:Fe},watch:{loginDialog:function(e,t){"edit"==e.type&&(this.loginForm.name=this.user.name,this.loginForm.avatar=this.user.avatar,this.avatarSrc=this.user.avatar)}},data:function(){var e=this;return{loading:!1,showTips:!1,avatarSrc:void 0,tips:{type:null,msg:null},loginForm:{name:null,avatar:null,email:null,password:null,pwdAgain:null},rules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur,change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:function(t,n,i){if("login"==e.loginDialog.type||!e.loginForm.pwdAgain)return i();n!==e.loginForm.pwdAgain&&e.$refs.loginForm.validateField("pwdAgain"),i()},trigger:"blur"},{min:5,max:10,message:"长度在 5 到 10 个字符",trigger:"blur"}],pwdAgain:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:function(t,n,i){if(!e.loginForm.password)return i();n!==e.loginForm.password?i(new Error("两次输入密码不一致!")):i()},trigger:"blur"},{min:5,max:10,message:"长度在 5 到 10 个字符",trigger:"blur"}]}}},computed:ie()({},Object(ae.e)(["loginDialog","user"])),methods:ie()({},Object(ae.d)(["setUser"]),Object(ae.b)(["loginSuccess","updateUser"]),{clearData:function(){this.showTips=!1,this.loginForm.name=null,this.loginForm.password=null,this.loginForm.pwdAgain=null,this.loginForm.email=null,this.loginForm.avatar=null,this.loginDialog.centerDialogVisible=!1},submitForm:function(e){var t=this;this.showTips=!1,this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;"login"==t.loginDialog.type?(t.loading=!0,t.$http.post("/login",{email:t.loginForm.email,password:t.loginForm.password}).then(function(e){t.setUser(e.data),t.tips={type:"ok",msg:e.data.msg},t.loginDialog.centerDialogVisible=!1,t.loginSuccess(e.data)},function(e){t.tips={type:"error",msg:e.data}}).finally(function(){t.loading=!1,t.showTips=!0})):(t.loading=!0,t.$http.post("/sign",t.loginForm).then(function(e){t.setUser(e.data),t.tips={type:"ok",msg:e.data.msg},t.loginDialog.centerDialogVisible=!1,t.loginSuccess(e.data)},function(e){t.tips={type:"error",msg:e.data}}).finally(function(){t.loading=!1,t.showTips=!0}))})},editForm:function(e){var t=this;this.showTips=!1,this.$refs[e].validate(function(e){if(!e)return console.log("error edit!!"),!1;t.loading=!0,t.updateUser(t.loginForm).then(function(e){t.tips={type:"ok",msg:e.ok},t.showTips=!0,t.loading=!1,t.loginDialog.centerDialogVisible=!1},function(e){t.tips={type:"error",msg:e},t.showTips=!0,t.loading=!1})})},resetForm:function(e){this.$refs[e].resetFields()},updateUserAvatar:function(e){var t=e.getCroppedCanvas({width:100,height:80}).toDataURL("image/jpg");this.avatarSrc=t,t&&(this.loginForm.avatar=t)}})},xe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["edit"!=e.loginDialog.type?n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:"login"==e.loginDialog.type?"登录":"注册",visible:e.loginDialog.centerDialogVisible,width:"35%",center:""},on:{"update:visible":function(t){e.$set(e.loginDialog,"centerDialogVisible",t)},close:e.clearData}},[n("el-form",{ref:"loginForm",staticClass:"demo-loginForm",attrs:{model:e.loginForm,rules:e.rules,"label-width":"100px","status-icon":""}},["sign"==e.loginDialog.type?n("el-form-item",{attrs:{label:"用户名称",prop:"name"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.loginForm.name,callback:function(t){e.$set(e.loginForm,"name",t)},expression:"loginForm.name"}})],1):e._e(),e._v(" "),n("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[n("el-input",{attrs:{type:"email","auto-complete":"off"},model:{value:e.loginForm.email,callback:function(t){e.$set(e.loginForm,"email",t)},expression:"loginForm.email"}})],1),e._v(" "),"sign"==e.loginDialog.type?n("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[e.avatarSrc?n("div",{staticClass:"avatar-image"},[n("img",{attrs:{src:e.avatarSrc}})]):e._e(),e._v(" "),n("el-button",{attrs:{id:"pick-avatar",size:"small"}},[e._v("选择头像")]),e._v(" "),n("avatar-cropper",{attrs:{trigger:"#pick-avatar","upload-handler":e.updateUserAvatar}})],1):e._e(),e._v(" "),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),"sign"==e.loginDialog.type?n("el-form-item",{attrs:{label:"确认密码",prop:"pwdAgain"}},[n("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginForm.pwdAgain,callback:function(t){e.$set(e.loginForm,"pwdAgain",t)},expression:"loginForm.pwdAgain"}})],1):e._e(),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("loginForm")}}},[e._v(e._s("login"==e.loginDialog.type?"登录":"注册"))]),e._v(" "),n("el-button",{on:{click:function(t){e.resetForm("loginForm")}}},[e._v("重置")])],1)],1),e._v(" "),e.showTips?n("span",["error"==e.tips.type?n("el-alert",{attrs:{title:e.tips.msg,type:"error",center:"","show-icon":"",closable:!1}}):e._e()],1):e._e()],1):e._e(),e._v(" "),"edit"==e.loginDialog.type?n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:"修改信息",visible:e.loginDialog.centerDialogVisible,width:"35%",center:""},on:{"update:visible":function(t){e.$set(e.loginDialog,"centerDialogVisible",t)},close:e.clearData}},[n("el-form",{ref:"loginForm",staticClass:"demo-loginForm",attrs:{model:e.loginForm,rules:e.rules,"label-width":"100px","status-icon":""}},[n("el-form-item",{attrs:{label:"用户名称",prop:"name"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.loginForm.name,callback:function(t){e.$set(e.loginForm,"name",t)},expression:"loginForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[e.avatarSrc?n("div",{staticClass:"avatar-image"},[n("img",{attrs:{src:e.avatarSrc}})]):e._e(),e._v(" "),n("el-button",{attrs:{id:"pick-avatar",size:"small"}},[e._v("选择头像")]),e._v(" "),n("avatar-cropper",{attrs:{trigger:"#pick-avatar","upload-handler":e.updateUserAvatar}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"确认密码",prop:"pwdAgain"}},[n("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.loginForm.pwdAgain,callback:function(t){e.$set(e.loginForm,"pwdAgain",t)},expression:"loginForm.pwdAgain"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editForm("loginForm")}}},[e._v("修改")]),e._v(" "),n("el-button",{on:{click:function(t){e.resetForm("loginForm")}}},[e._v("重置")])],1)],1),e._v(" "),e.showTips?n("span",["error"==e.tips.type?n("el-alert",{attrs:{title:e.tips.msg,type:"error",center:"","show-icon":"",closable:!1}}):e._e()],1):e._e()],1):e._e()],1)},staticRenderFns:[]};var Oe=n("ngHh")(Le,xe,!1,function(e){n("qpFk")},"data-v-b37fe600",null).exports,De={name:"shChatDialog",components:{AvatarCropper:Fe},data:function(){return{addFriendsKey:null,addGroupsKey:null,checkedList:[],checkedGroupsList:[],avatarSrc:null,groupsForm:{name:null,avatar:null},rules:{name:[{required:!0,message:"请输入群组名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]}}},computed:ie()({},Object(ae.e)(["searchResultList","searchResultGroupsList","addFriOrGroDialog"])),methods:ie()({},Object(ae.b)(["searchUsers","searchGroup","addFriend","addGroup","createGroup"]),Object(ae.d)(["setAddFriOrGroDialog"]),{init:function(){this.addFriendsKey=null,this.addGroupsKey=null,this.checkedList=[],this.checkedGroupsList=[],this.avatarSrc=null,this.groupsForm={name:null,avatar:null}},searchFirends:function(){this.addFriendsKey&&this.searchUsers(this.addFriendsKey)},searchGroups:function(){this.addGroupsKey&&this.searchGroup(this.addGroupsKey)},addFriends:function(){for(var e in this.checkedList)this.addFriend(this.checkedList[e]);this.init(),this.setAddFriOrGroDialog({type:null,show:!1})},addGroups:function(){for(var e in this.checkedGroupsList)this.addGroup(this.checkedGroupsList[e]);this.init(),this.setAddFriOrGroDialog({type:null,show:!1})},resetForm:function(e){this.$refs[e].resetFields()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.createGroup(t.groupsForm),t.setAddFriOrGroDialog({type:null,show:!1}),t.init()})},updateUserAvatar:function(e){var t=e.getCroppedCanvas({width:100,height:80}).toDataURL("image/jpg");this.avatarSrc=t,t&&(this.groupsForm.avatar=t)}})},Ae={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-dialog",{attrs:{size:"tiny",visible:e.addFriOrGroDialog.show},on:{"update:visible":function(t){e.$set(e.addFriOrGroDialog,"show",t)},close:e.init}},[n("el-tabs",{staticClass:"dialog",model:{value:e.addFriOrGroDialog.type,callback:function(t){e.$set(e.addFriOrGroDialog,"type",t)},expression:"addFriOrGroDialog.type"}},[n("el-tab-pane",{attrs:{label:"添加好友",name:"friends"}},[n("el-input",{staticClass:"addInput",attrs:{placeholder:"请输入好友名称 Enter搜索"},on:{change:e.searchFirends},model:{value:e.addFriendsKey,callback:function(t){e.addFriendsKey=t},expression:"addFriendsKey"}},[n("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},on:{click:e.searchFirends},slot:"prefix"})]),e._v(" "),n("div",{staticClass:"searchList"},[n("el-checkbox-group",{model:{value:e.checkedList,callback:function(t){e.checkedList=t},expression:"checkedList"}},e._l(e.searchResultList,function(t,i){return n("el-checkbox",{key:i,staticClass:"addCheck",attrs:{disabled:t.have,label:t}},[n("img",{staticClass:"addImg",attrs:{src:t.avatar}}),e._v(" "),n("h4",{staticClass:"addName"},[e._v(e._s(t.name))]),e._v(" "),t.have?n("span",[e._v("已添加")]):e._e()])}))],1),e._v(" "),n("div",{staticClass:"addBtn"},[n("el-button",{attrs:{disabled:!e.checkedList.length>0,type:"success"},on:{click:e.addFriends}},[e._v("加入"+e._s(e.checkedList.length>0?e.checkedList.length:null))])],1)],1),e._v(" "),n("el-tab-pane",{attrs:{label:"添加群组",name:"groups"}},[n("el-input",{staticClass:"addInput",attrs:{placeholder:"请输入群组名称 Enter搜索"},on:{change:e.searchGroups},model:{value:e.addGroupsKey,callback:function(t){e.addGroupsKey=t},expression:"addGroupsKey"}},[n("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},on:{click:e.searchGroups},slot:"prefix"})]),e._v(" "),n("div",{staticClass:"searchList"},[n("el-checkbox-group",{model:{value:e.checkedGroupsList,callback:function(t){e.checkedGroupsList=t},expression:"checkedGroupsList"}},e._l(e.searchResultGroupsList,function(t,i){return n("el-checkbox",{key:i,staticClass:"addCheck",attrs:{disabled:t.have,label:t}},[n("img",{staticClass:"addImg",attrs:{src:t.avatar}}),e._v(" "),n("h4",{staticClass:"addName"},[e._v(e._s(t.name))]),e._v(" "),t.have?n("span",[e._v("已添加")]):e._e()])}))],1),e._v(" "),n("div",{staticClass:"addBtn"},[n("el-button",{attrs:{disabled:!e.checkedGroupsList.length>0,type:"success"},on:{click:e.addGroups}},[e._v("加入"+e._s(e.checkedGroupsList.length>0?e.checkedGroupsList.length:null))])],1)],1),e._v(" "),n("el-tab-pane",{attrs:{label:"创建群组",name:"createGroups"}},[n("el-form",{ref:"groupsForm",staticClass:"demo-groupsForm",attrs:{model:e.groupsForm,rules:e.rules,"label-width":"100px","status-icon":""}},[n("el-form-item",{attrs:{label:"群组名称",prop:"name"}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.groupsForm.name,callback:function(t){e.$set(e.groupsForm,"name",t)},expression:"groupsForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"头像",prop:"avatar"}},[e.avatarSrc?n("div",{staticClass:"avatar-image"},[n("img",{attrs:{src:e.avatarSrc}})]):e._e(),e._v(" "),n("el-button",{attrs:{id:"pick-groups-avatar",size:"small"}},[e._v("选择头像")]),e._v(" "),n("avatar-cropper",{attrs:{trigger:"#pick-groups-avatar","upload-handler":e.updateUserAvatar}})],1),e._v(" "),n("el-form-item",[n("el-button",{staticStyle:{"{float":"right}"},attrs:{type:"primary"},on:{click:function(t){e.submitForm("groupsForm")}}},[e._v("创建")]),e._v(" "),n("el-button",{on:{click:function(t){e.resetForm("groupsForm")}}},[e._v("重置")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var Ge=n("ngHh")(De,Ae,!1,function(e){n("ofC9")},"data-v-3ff78e36",null).exports,Me={name:"shHeader",data:function(){return{scrollTop:0}},props:{value:[String]},computed:{searchModel:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},methods:{search:function(){this.value&&this.$emit("click")},querySearch:function(e,t){t([])},handleScroll:function(){this.scrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop}},mounted:function(){window.addEventListener("scroll",this.handleScroll)},components:{shLogin:ge,shLoginDialog:Oe,shChatDialog:Ge}},Ie={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{class:{down:0!==e.scrollTop},attrs:{id:"header"}},[n("div",{staticClass:"shHeader"},[n("a",{staticClass:"shImg"}),e._v(" "),n("div",{staticClass:"shSearch"},[n("el-autocomplete",{staticClass:"inline-block",attrs:{"suffix-icon":"el-icon-search",placeholder:"请输入搜索内容",size:"medium","trigger-on-focus":!1,"fetch-suggestions":e.querySearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.search(t)}},model:{value:e.searchModel,callback:function(t){e.searchModel=t},expression:"searchModel"}},[n("el-button",{attrs:{slot:"append"},on:{click:e.search},slot:"append"},[e._v("搜索一下")])],1)],1),e._v(" "),n("sh-login")],1)]),e._v(" "),n("sh-login-dialog"),e._v(" "),n("sh-chat-dialog")],1)},staticRenderFns:[]};var Se=n("ngHh")(Me,Ie,!1,function(e){n("AjxE")},"data-v-2123c560",null).exports,Ne={name:"shBody",data:function(){return{baidu:null,biyin:null,sogou:null,type:"baidu",searchValue:null,loading:!1,biyinType:"in",hostname:window.location.host}},methods:ie()({},Object(ae.b)(["logout"]),{tabsClick:function(e){this.loading||this[e.name]||!this.searchValue||this.queryClick()},biyinClick:function(){this.searchValue&&this.queryClick()},queryClick:function(e){var t=this;this.loading=!0,this.$http.post("/query",{key:e||encodeURI(this.searchValue),type:this.type,link:!!e,biyinType:this.biyinType}).then(function(e){t[e.data.type]=e.data.data,t.searchValue=decodeURI(e.data.returnKey),window.pageYOffset=0,document.documentElement.scrollTop=0,document.body.scrollTop=0,t.loading=!1},function(e){t[e.data.type]='<div style="text-align:center;">请求出错啦</div>',t.loading=!1})}}),mounted:function(){var e=this;document.onclick=function(t){for(var n=t.target;n.tagName&&"A"!==n.tagName&&n;)n=n.parentNode?n.parentNode:null;if(n&&n.href)return n.host==e.hostname?e.queryClick(n.pathname+n.search):window.open(n.href),!1},window.onbeforeunload=function(){return"加载"}},components:{shHeader:Se}},Te={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("sh-header",{on:{click:e.queryClick},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),n("div",{staticClass:"clearfix",attrs:{id:"body"}},[n("div",{staticClass:"gap"}),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"bodyQuery",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255, 255, 255, 0.6)"}},[n("el-tabs",{on:{"tab-click":e.tabsClick},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[n("el-tab-pane",{attrs:{name:"baidu"}},[n("span",{attrs:{slot:"label"},slot:"label"},[e._v("百度")]),e._v(" "),n("div",{domProps:{innerHTML:e._s(e.baidu)}})]),e._v(" "),n("el-tab-pane",{attrs:{name:"biyin"}},[n("span",{attrs:{slot:"label"},slot:"label"},[e._v("必应")]),e._v(" "),n("el-radio-group",{attrs:{size:"small"},on:{change:e.biyinClick},model:{value:e.biyinType,callback:function(t){e.biyinType=t},expression:"biyinType"}},[n("el-radio-button",{attrs:{label:"in"}},[e._v("国内版")]),e._v(" "),n("el-radio-button",{attrs:{label:"out"}},[e._v("国际版")])],1),e._v(" "),n("div",{domProps:{innerHTML:e._s(e.biyin)}})],1),e._v(" "),n("el-tab-pane",{attrs:{name:"sogou"}},[n("span",{attrs:{slot:"label"},slot:"label"},[e._v("搜狗")]),e._v(" "),n("div",{domProps:{innerHTML:e._s(e.sogou)}})])],1)],1),e._v(" "),n("div",{staticClass:"bodynews"})])],1)},staticRenderFns:[]};var He={name:"App",components:{shBody:n("ngHh")(Ne,Te,!1,function(e){n("JHnt")},"data-v-05f32949",null).exports}},$e={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("sh-body")],1)},staticRenderFns:[]};var Re=n("ngHh")(He,$e,!1,function(e){n("nCWG")},null,null).exports,Ue=n("jGYP"),Ee={loginDialog:{type:"login",centerDialogVisible:!1},addFriOrGroDialog:{type:null,show:!1},user:{_id:null,name:null,avatar:null},searchResultList:[],searchResultGroupsList:[],friendsList:[],groupsList:[],currentOne:null,messages:{},activeMsgList:[],counts:{},noticeList:[],isOpen:!1,groupMemberList:[]},qe={loginError:function(e,t){e.user={_id:null,name:null,avatar:null},alert(t.msg)},setOpen:function(e,t){e.isOpen=t},setLoginDialog:function(e,t){e.loginDialog=t},setAddFriOrGroDialog:function(e,t){e.searchResultList=[],e.searchResultGroupsList=[],e.addFriOrGroDialog=t},setUser:function(e,t){e.user=t},setSearchResult:function(e,t){e.searchResultList=t},setSearchGroupsResult:function(e,t){e.searchResultGroupsList=t},setFriendsList:function(e,t){e.friendsList=t},setGroupsList:function(e,t){e.groupsList=t},setGroupMemberList:function(e,t){e.groupMemberList=t},pushGroupsList:function(e,t){e.groupsList.push(t)},pushFriendsList:function(e,t){e.friendsList.push(t)},deleteFriendsList:function(e,t){for(var n in e.friendsList)if(e.friendsList[n]._id===t._id)return void e.friendsList.splice(n,1)},deleteGroupsList:function(e,t){for(var n in e.groupsList)if(e.groupsList[n]._id===t._id)return void e.groupsList.splice(n,1)},changeCurrentOne:function(e,t){e.currentOne=null,e.currentOne=t,te.default.set(e.counts,t._id,0)},clearCurrentone:function(e){te.default.set(e.counts,e.currentOne._id,0),e.currentOne=null},pushMsg:function(e,t){if(e.messages[t.msgId])e.messages[t.msgId].push(t);else if(te.default.set(e.messages,t.msgId,[t]),t.groupId){for(var n=0;n<e.groupsList.length;n++)if(e.groupsList[n]._id==t.groupId)return void e.activeMsgList.push({name:e.groupsList[n].name,owner:e.groupsList[n].owner,avatar:e.groupsList[n].avatar,_id:t.groupId})}else e.activeMsgList.push({name:t._id?e.currentOne.name:t.name,avatar:t.avatar,_id:t.msgId})},addCount:function(e,t){e.counts[t]?(e.counts[t]=parseInt(e.counts[t])+1,te.default.set(e.counts,t,e.counts[t])):te.default.set(e.counts,t,1)},addFriendOk:function(e,t){e.noticeList.push(t)},delNoticeListItem:function(e,t){for(var n in e.noticeList)if(e.noticeList[n]._id===t._id)return void e.noticeList.splice(n,1)},delActiveMsgListItem:function(e,t){for(var n in e.messages[t._id]=null,e.activeMsgList)if(e.activeMsgList[n]._id===t._id)return void e.activeMsgList.splice(n,1)}},je=n("UIuv"),Ke=n.n(je),Pe=n("3SZ7"),Ve=n.n(Pe),Be=n("KdrC"),ze=n.n(Be).a.connect("/");function Xe(e,t,n){!function(){for(var e in ze.$events)void 0!=e&&ze.removeAllListeners(e)}(),ze.on("message",function(e){var i=e.from,a=e.content,r=e.groupId,s=e.groupName;r?(n("pushMsg",{groupId:r,name:i.name,avatar:i.avatar,msgId:r,content:a}),t.currentOne&&t.currentOne._id==r&&t.isOpen||n("addCount",r)):(n("pushMsg",{name:i.name,avatar:i.avatar,msgId:i._id,content:a}),t.currentOne&&t.currentOne._id==i._id&&t.isOpen||n("addCount",i._id)),t.isOpen||window.vue.$notify({title:i.name+(s?" "+s:""),dangerouslyUseHTMLString:!0,position:"bottom-right",message:a.indexOf("<img")>-1?"[图片]":a}),ze.emit("message",{ok:"信息成功送达"})}),ze.on("addFriendOk",function(e){var t=e.from;t.type="add",n("addFriendOk",t)})}var Ye=function(e){return new Ke.a(function(t,n){ze.emit("loginSuccess",e),ze.once("loginSuccess",function(e){return"error"===e.type?n(e):t(e)})})},Ze=function(e){return new Ke.a(function(t,n){ze.emit("getFriends",{from:e}),ze.once("getFriends",function(e){return e.msg||e.message?n(e):t(e)})})},Je=function(e){var t=e.keyword,n=e.from;return new Ke.a(function(e,i){ze.emit("searchUsers",{keyword:t,from:n}),ze.once("searchUsers",function(t){return t.msg||t.message?i(t):e(t)})})},Qe=function(e){return new Ke.a(function(t,n){ze.emit("addFriend",e),ze.once("addFriend",function(e){return e.error?n(e.error):t(e.ok)})})},We=function(e){return new Ke.a(function(t,n){ze.emit("addFriendOk",e),ze.once("okAddFriend",function(e){return e.error?n(e.error):t(e.ok)})})},et=function(e){return new Ke.a(function(t,n){ze.emit("pushMsg",e),ze.once("pushMsg",function(e){return e.error?n(e.error):t(e.ok)})})},tt=function(e){return new Ke.a(function(t,n){ze.emit("removeFriend",e),ze.once("removeFriend",function(e){return e.error?n(e.error):t(e.ok)})})},nt=function(e){return new Ke.a(function(t,n){ze.emit("createGroup",e),ze.once("createGroup",function(e){return e.error?n(e.error):t(e)})})},it=function(e){return new Ke.a(function(t,n){ze.emit("getGroups",{from:e}),ze.once("getGroups",function(e){return e.error?n(e.error):t(e)})})},at=function(e){return new Ke.a(function(t,n){ze.emit("removeGroup",e),ze.once("removeGroup",function(e){return e.error?n(e.error):t(e)})})},rt=function(e){var t=e.keyword,n=e.from;return new Ke.a(function(e,i){ze.emit("searchGroups",{keyword:t,from:n}),ze.once("searchGroups",function(t){return t.error?i(t.error):e(t)})})},st=function(e){return new Ke.a(function(t,n){ze.emit("addGroup",e),ze.once("addGroup",function(e){return e.error?n(e.error):t(e)})})},ot=function(e){return new Ke.a(function(t,n){ze.emit("updateUser",e),ze.once("updateUser",function(e){return e.msg||e.message?n(e):t(e)})})},lt=function(e){return new Ke.a(function(t,n){ze.emit("getGroupMember",e),ze.once("getGroupMember",function(e){return e.msg||e.message?n(e):t(e)})})},ct={loginSuccess:function(e,t){var n=e.state,i=e.commit;return Ye(t).then(function(e){Ze(n.user._id).then(function(e){i("setFriendsList",e)}),it(n.user._id).then(function(e){i("setGroupsList",e),function(e,t,n){for(var i in e)ze.on(e[i]._id,function(e){e.from;var t=e.data;window.vue.$notify({title:t.name,dangerouslyUseHTMLString:!0,position:"bottom-right",message:t.content})})}(e)}),Xe(0,n,i)},function(e){i("loginError",e)})},searchUsers:function(e,t){var n=e.state,i=e.commit;return Je({keyword:t,from:n.user._id}).then(function(e){for(var t in e)Ve()(n.friendsList).indexOf(Ve()(e[t]))>-1&&(e[t].have=!0);i("setSearchResult",e)})},searchGroup:function(e,t){var n=e.state,i=e.commit;return rt({keyword:t,from:n.user._id}).then(function(e){for(var t in e)Ve()(n.groupsList).indexOf(Ve()(e[t]._id))>-1&&(e[t].have=!0);i("setSearchGroupsResult",e)})},addFriend:function(e,t){var n=e.state,i=e.commit;return Qe({from:{_id:n.user._id,name:n.user.name,avatar:n.user.avatar},friendId:t._id}).then(function(e){i("pushFriendsList",t),t.type="resolve",i("addFriendOk",t)},function(e){t.type="reject",i("addFriendOk",t)})},addFriendOk:function(e,t){var n=e.state,i=e.commit;return i("delNoticeListItem",t.data),We({_id:n.user._id,ok:t.mask}).then(function(e){i("pushFriendsList",t.data)},function(e){console.log(e)})},changeCurrentOne:function(e,t){(0,e.commit)("changeCurrentOne",t)},pushMsg:function(e,t){var n=e.state,i=e.commit,a={from:n.user,content:t};return n.currentOne.owner?(a.groupId=n.currentOne._id,a.groupName=n.currentOne.name):a.friendId=n.currentOne._id,i("pushMsg",{name:n.user.name,avatar:n.user.avatar,_id:n.user._id,groupId:n.currentOne.owner?n.currentOne._id:null,msgId:n.currentOne._id,content:t}),et(a).then(function(e){},function(e){alert(e)})},deleteUser:function(e,t){var n=e.commit,i=e.state;return tt({fromId:i.user._id,friendId:t._id}).then(function(e){i.currentOne=null,n("deleteFriendsList",{name:t.name,_id:t._id})},function(e){alert(e)})},deleteGroup:function(e,t){var n=e.commit,i=e.state;return at({fromId:i.user._id,groupId:t._id}).then(function(e){var a;i.currentOne=null,n("deleteGroupsList",{name:t.name,_id:t._id}),a=t._id,ze.removeAllListeners(a)},function(e){alert(e)})},createGroup:function(e,t){var n=e.commit,i=e.state;return nt({from:i.user._id,data:{name:t.name,avatar:t.avatar}}).then(function(e){n("pushGroupsList",{name:t.name,avatar:e.avatar,_id:e.groupId,owner:i.user._id})},function(e){alert(e)})},addGroup:function(e,t){var n,i=e.commit,a=e.state;return n=t._id,ze.on(n,function(e){e.from;var t=e.data;window.vue.$notify({title:t.name,dangerouslyUseHTMLString:!0,position:"bottom-right",message:t.content})}),st({from:a.user._id,groupId:t._id}).then(function(){i("pushGroupsList",{name:t.name,avatar:t.avatar,_id:t._id,owner:t.owner?t.owner:"null"})})},updateUser:function(e,t){var n=e.commit,i=e.state,a={from:i.user._id,data:t};return new Ke.a(function(e,r){ot(a).then(function(a){n("setUser",{_id:i.user._id,name:t.name,avatar:t.avatar}),e(a)},function(e){r(e)})})},getGroupMember:function(e,t){var n=e.commit;e.state;n("setGroupMemberList",[]);var i=t._id;return lt({groupId:i}).then(function(e){n("setGroupMemberList",e)})}};te.default.use(ae.a);var ut=new ae.a.Store({state:Ee,getters:{msgListNum:function(e){var t=0;for(var n in e.counts)t+=e.counts[n];return t}},mutations:qe,actions:ct}),dt=n("S1F6"),mt=n.n(dt);te.default.use(mt.a),te.default.config.productionTip=!1,te.default.use(Ue.a),te.default.use(ee.a),te.default.use(Q.a),te.default.use(Z.a),te.default.use(X.a),te.default.use(B.a),te.default.use(P.a),te.default.use(j.a.directive),te.default.use(E.a),te.default.use(R.a),te.default.use(H.a),te.default.use(N.a),te.default.use(I.a),te.default.use(G.a),te.default.use(D.a),te.default.use(x.a),te.default.use(F.a),te.default.use(k.a),te.default.use(y.a),te.default.use(_.a),te.default.use(v.a),te.default.use(f.a),te.default.use(m.a),te.default.use(u.a),te.default.use(l.a),te.default.prototype.$notify=s.a,te.default.prototype.$confirm=a.a.confirm,window.vue=new te.default({el:"#app",store:ut,components:{App:Re},template:"<App/>"})},ONfh:function(e,t){},RABp:function(e,t){},RJkU:function(e,t){},"S+8z":function(e,t){},"V/92":function(e,t){},VVqU:function(e,t){},X0dM:function(e,t){},X7Q4:function(e,t){},YtW1:function(e,t){},ZD0t:function(e,t){},ZM3P:function(e,t){},ZfCT:function(e,t){},fqtM:function(e,t){},gT1N:function(e,t){},k2Oz:function(e,t){},kDaR:function(e,t){},nCWG:function(e,t){},nXbH:function(e,t){},ofC9:function(e,t){},qpFk:function(e,t){},qqnD:function(e,t){},rI3P:function(e,t){},uezj:function(e,t){},vJvE:function(e,t){},xet3:function(e,t){e.exports="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},xpkF:function(e,t){},ziMA:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.cbfa5c699666dee66561.js.map